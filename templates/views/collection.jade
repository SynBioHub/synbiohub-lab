
extends ../layouts/topLevel.jade

include ../mixins/blast-button.jade
include ../mixins/mutable-fields.jade
include ../mixins/attachments.jade
include ../mixins/citations.jade

link(href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css", rel="stylesheet")
script(src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js")

block js
    script.
        $(document).ready(function() {
                $('.display').DataTable({
                    "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]]
                })
            } );

block topLevelIcon
    span.topLevelIcon.fa.fa-folder

block modal
    div.modal.fade#iconModal(tabindex="-1", role="dialog")
        div.modal-dialog(role="document")
            div.modal-content
                div.modal-header
                    button.close(type="button", data-dismiss="modal", arial-label="close")
                        span(aria-hidden="true") &times;
                    h4.modal-title Change Collection Icon
                div.modal-body
                    div.row
                        div.col-sm-6
                            if (collectionIcon)
                                h5 Current Icon
                                img(src=collectionIcon, style="width: 100%")
                            else
                                h5 No Icon Set!
                        div.col-sm-6
                            h5 Upload New Icon
                            form#iconForm.form(method="POST", enctype="multipart/form-data", action=url + '/icon')
                                input(type="hidden", value=objectURL, name="collectionUrl")
                                input(type="hidden", value=collection.uri, name="collectionUri")
                                input.form-control(type="file", name="collectionIcon")

                div.modal-footer
                    button.btn.btn-danger(data-dismiss="modal") Close
                    button.btn.btn-primary(type="submit", form="iconForm") Save changes


block topLevelPreview
    block table
        table#datatable.display.table.table-striped.entry-detail-table.sbh-collection-members-datatable.table-hover
            thead
                th Identifier
                th Name
                th Type
                th Description
            tbody
                for member in collection.members
                    if (member.version!= 'null' && member.displayType !== "Nucleic Acid Sequence" && member.displayType !== "Amino Acid Sequence" && !CDCheck.includes(member.displayId))
                        tr
                            td
                                a(href=memberURLs.get(member.uri)) #{member.displayId}
                            td
                                a(href=memberURLs.get(member.uri)) #{member.name}
                            td
                                a(href=memberURLs.get(member.uri)) #{member.displayType}
                            td #{member.description}
                for componentList in components
                    tr

                        td
                            a(href=memberURLs.get(componentList[0].uri)) #{componentList[0].displayId}
                            br
                            ||____
                            - count = 0
                            for component in componentList.slice(1, componentList.length)
                                - count += 1
                                a(href=memberURLs.get(component.uri)) #{component.displayId}
                                if (count !== componentList.length -1 )
                                    br
                                    ||____


                        td
                            a(href=memberURLs.get(componentList[0].uri)) #{componentList[0].name}
                            br
                            |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            - count = 0
                            for component in componentList.slice(1, componentList.length)
                                - count += 1
                                a(href=memberURLs.get(component.uri)) #{component.name}
                                if (count !== componentList.length -1 )
                                    br
                                    |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

                        td
                            a(href=memberURLs.get(componentList[0].uri)) #{componentList[0].displayType}
                            br
                            |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            - count = 0
                            for component in componentList.slice(1, componentList.length)
                                - count += 1
                                a(href=memberURLs.get(component.uri)) #{component.displayType}
                                if (count !== componentList.length -1 )
                                    br
                                    |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

                        td  #{componentList[0].description}
                            br
                            |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            - count = 0
                            for component in componentList.slice(1, componentList.length)
                                - count += 1
                                a #{component.description}
                                if (count !== componentList.length -1 )
                                    br
                                    |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

                                
    block creationButtons
        div.sbh-project-add.creationButtons
            a(href=uri.toURL() + '/addDesign')
                button.btn.sbh-design-button
                    span.fa.fa-plus
                    |  Add design
            a(href=uri.toURL() + '/addConstruct')
                button.btn.sbh-construct-button
                    span.fa.fa-plus
                    |  Add construct
            a(href=uri.toURL() + '/addExperiment')
                button.btn.sbh-experiment-button
                    span.fa.fa-plus
                    |  Add experiment


block topLevelButtons
    if locals.user && (locals.user.isCurator || locals.user.isAdmin)
        li.btn.btn-success
            a(data-toggle="modal", data-target="#iconModal", title='Change Collection Icon',style="color:white")
                span.fa.fa-file-image-o
    if typeof(remote) !== undefined
        li.btn.btn-success
            a(href=copyFromRemote, title='Copy to SynBioHub',style="color:white")
               span.fa.fa-share-alt


block details
block Attachments





